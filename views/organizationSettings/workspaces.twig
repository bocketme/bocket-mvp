{% extends './layout.twig' %}

{% block body %}

    <div class="row" id="main">
        <div id="left-pannel" class="col s12 m4 l4 xl3 row">
            <div id="sideNav" class="col s2 m2 l2 xl2">
                {% include './sideNav.twig' %}
            </div>
            <div id="options" class="col s10 m10 l10 xl10">
                <div>
                    <a href="/organization/{{ currentOrganization._id }}">Organization</a>
                    <hr style="margin: 0% 5%;">
                    <a class="disabled" href="/organization/{{ currentOrganization._id }}/workspaces">Workspaces</a>
                    <hr style="margin: 0% 5%;">
                    <a href="/organization/{{ currentOrganization._id }}/members">Members</a>
                </div>
            </div>
        </div>
        <div class="col s12 m8 l8 xl9" style="height: 100%">

            {% include './header.twig' %}
            <div class="col s12">
                <div class="row overflow-hide">
                    <div class="col s12">
                        <ul class="tabs">
                            {% for workspace in workspaces %}
                                <li class="tab">
                                    <a href="#{{ workspace._id }}-tabs" class="active workspace-list truncate">{{ workspace.name }}</a>
                                </li>
                            {% endfor %}
                            {% if currentUser.rights > 4 %}
                                <li class="tab">
                                    <a target="_blank" class="modal-trigger" href="#workspace-creation" style="text-transform: none; color: #4A90E2;">+ Add Workspace</a>
                                </li>
                            {% endif %}
                        </ul>
                    </div>
                    {% for workspace in workspaces %}
                        <div id="{{ workspace._id }}-tabs" class="col s12">
                            <div class="overflow-content">
                                <div class="container">
                                    <div class="list-user">
                                        <form action="/workspace/{{ workspace._id }}/information" method="post">
                                            {#
                                                <div id="organization-image" style="background-image: url('/organization/image/{{ currentOrganization._id }}')" class="col s4">
                                                    {% if (user.rights > 4 or workspace.isProductManager) %}
                                                    <div class="file-field input-field">
                                                        <div class="change-organization">
                                                            <span>Edit</span>
                                                            <input type="file" name="image" accept="image/*">
                                                        </div>
                                                        <div class="file-path-wrapper">
                                                            <input class="file-path validate" type="text" style="display: none">
                                                        </div>
                                                    </div>
                                                    {% endif %}
                                                </div>
                                            #}

                                            <div style="position: relative;margin-top: 49px; {#margin-left: 15px;#}">
                                                <input id="workspace-name" name="name" type="text" value="{{ workspace.name }}" {% if not (currentUser.rights > 4 or workspace.isProductManager) %} disabled="disabled" style="color: black" {% endif %}>
                                                {% if (currentUser.rights > 4 or workspace.isProductManager) %}
                                                    <i id="edit" class="material-icons">edit</i>
                                                {% endif %}
                                            </div>
                                            <div class="row">
                                                <div class="input-field col s12">
                                                    <textarea id="textarea1" name="description" class="materialize-textarea">{{ workspace.description }}</textarea>
                                                    <label for="textarea1">Description</label>
                                                </div>
                                                {% if (currentUser.rights > 4 or workspace.isProductManager) %}
                                                    <button class="btn btn-confirm cancel right" type="submit">Submit
                                                    </button>
                                                {% endif %}
                                            </div>
                                        </form>
                                        <div id="workspace-{{workspace._id}}" class="bloc">
                                            {% include './workspaceUserList.twig' %}
                                        </div>
                                        <div class="bloc col s12">
                                            {% if currentUser.rights > 4 %}
                                                <a class="btn outline-button modal-trigger separator col s12 m12 l5" workspaceId="{{workspace._id}}" href="#confirm-workspace-delete">Delete the workspace</a>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    {% include 'modals/invitationWorkspace.twig' %}
    {% include 'modals/confirmWorkspaceDeletion.twig' %}

{% endblock %}

{% block css %}{% endblock %}

{% block js %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.1/moment.min.js"></script>
    <script src="/js/settings/deleteWorkspace.js"></script>
    <script>
        $(document).ready(function () {
            $('ul.tabs').tabs();
        });
    </script>
    <script src="/js/settings/invitationWorkspace.js"></script>
{% endblock %}
